<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Agriculture Database Access</title>

  <!-- Code to create all the object styles for the website-->
  <style>
    .hidden { /* Allows things to be hidden untl shown*/ 
      display: none;
    }
    /* Creates the formating for the entire website*/
    body {
      font-family: Arial, Helvetica, sans-serif;
      background-color: #f4f6f9;
      margin: 0;
      padding: 0;
    }
    /* Creates the styling for the title*/
    .title {
      background: linear-gradient(to right, #4CAF50, #2E7D32);
      color: white;
      padding: 20px;
      text-align: center;
      font-size: 42px;
      font-weight: bold;
      border-bottom: 4px solid #1B5E20;
    }
    /* Creates the styling for the container forms a box around the items*/
    .container {
      max-width: 900px;
      margin: 30px auto;
      padding: 20px;
      background: white;
      border-radius: 10px;
      box-shadow: 0px 4px 10px rgba(0,0,0,0.1);
    }
    /* Creates the styling for the subtitle*/
    .subtitle {
      font-size: 24px;
      font-weight: bold;
      margin: 20px 0 10px;
      color: #2E7D32;
    }
    /* Creates the styling for the form*/
    .dropdown {
      position: relative;
    }

    /* Style the dropdown button */
    .dropbtn {
      background-color: #4CAF50;
      color: white;
      padding: 16px;
      font-size: 16px;
      border: none;
      cursor: pointer;
    }

    /* Dropdown content */
    .dropdown-content {
      display: none;
      position: absolute;
      background-color: #f9f9f9;
      min-width: 200px;
      box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
    }

    /* Links inside dropdown content */
    .dropdown-content a {
      color: black;
      padding: 12px 16px;
      text-decoration: none;
      display: block;
    }

    /* Change color of dropdown links on hover */
    .dropdown-content a:hover {
      background-color: #f1f1f1
    }

    /* Show the dropdown content on hover */
    .dropdown:hover .dropdown-content {
      display: block;
    }

    /* Change background color of dropdown button on hover */
    .dropdown:hover .dropbtn {
      background-color: #3e8e41;
    }
    /* Creates the styling for the form*/
    textarea {
      width: 100%;
      height: 120px;
      padding: 10px;
      font-size: 16px;
      font-family: monospace;
      border: 2px solid #ccc;
      border-radius: 8px;
      resize: vertical;
      outline: none;
    }
    /* Creates the styling for when the textarea is clicked - border will change colour*/
    textarea:focus {
      border-color: #4CAF50;
    }

    /* Creates the styling for the button*/
    button {
      margin-top: 15px;
      padding: 12px 25px;
      font-size: 16px;
      background: #4CAF50;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: 0.2s;
    }
    /* Creates the styling for when the button is hovered over*/
    button:hover {
      background: #45a049;
    }
    /* Creates the styling for the output box*/
    #output-box {
      margin-top: 20px;
      padding: 15px;
      background: #1e1e1e;
      color: #e0e0e0;
      border-radius: 8px;
      font-family: monospace;
      font-size: 14px;
      max-height: 400px;
      overflow-y: auto;
    }
  </style>

</head>
<body>
  <div class="title">Agriculture Database Access</div>
  <div class="container"> <!-- Uses the container format so everything in these tags is in a box -->
    <div class="subtitle">Which Request Do You Want To Perform?</div>
    <div>For more complex queries and composite tables use the full query interface.</div>
    <div class="dropdown">
      <button class="dropbtn"> Requests</button>
      <div class="dropdown-content">
        <a href="#" data-target="GET">GET</a>
        <a href="#" data-target="POST">POST</a>
        <a href="#" data-target="PUT">PUT</a>
        <a href="#" data-target="PATCH">PATCH</a>
        <a href="#" data-target="DELETE">DELETE</a>
        <a href="#" data-target="FULLQUERY">FULL QUERY</a>

      </div>
    </div>
  </div>

  <!-- Interface for the GET request -->
  <section id="GET" class="hidden">
    <div class="container">
      <div class="subtitle">Enter Your GET Request</div>
        <form id="get-form">
          <label>Table:</label>
            <input type="text" id="get-table" placeholder="e.g. Farm"><br><br>
      
          <label>ID (optional):</label>
            <input type="text" id="get-id" placeholder="e.g. 1"><br><br>
    
        <button type="submit">Run GET</button>
        </form>
    </div>
  </section>

  <!-- Interface for the POST request -->
  <section id="POST" class="hidden">
    <div class="container">
      <div class="subtitle">Enter Your POST Request - One row at a time</div>
      <form id="post-form">
        <label>Table:</label>
        <input type="text" id="post-table" placeholder="e.g. Farm"><br><br>
  
        <label for="post-data">Data (JSON):</label><br>
        <textarea id="post-data" name="data" rows="6" cols="40"
          placeholder='{"farmID":1,"farm_Location":"Kent"}'></textarea><br><br>
        <button type="submit">Run POST</button>
      </form>
    </div>
  </section>

  <!-- Interface for the PUT request -->
  <section id="PUT" class="hidden">
    <div class="container">
      <div class="subtitle">Enter Your PUT Request</div>
      <form id="put-form">

        <!-- Table input -->
        <label for="put-table">Table:</label>
        <input type="text" id="put-table" placeholder="e.g. Farm"><br><br>

        <!-- ID to replace -->
        <label for="put-id">Row ID to Replace:</label>
        <input type="text" id="put-id" placeholder="e.g. 1"><br><br>

        <!-- New JSON data -->
        <label for="put-data">New Data (JSON):</label><br>
        <textarea id="put-data" name="data" rows="6" cols="40" placeholder='{"name": "Updated Farm", "size": 200}'></textarea><br><br>

        <!-- Submit -->
        <button type="submit">Run PUT</button>
      </form>
    </div>
  </section>

<!-- Interface for the PATCH request -->
<section id="PATCH" class="hidden">
  <div class="container">
    <div class="subtitle">Enter Your PATCH Request</div>
    <form id="patch-form">

      <!-- Table input -->
      <label for="patch-table">Table:</label>
      <input type="text" id="patch-table" placeholder="e.g. Farm"><br><br>

      <!-- ID to update -->
      <label for="patch-id">Row ID to Update:</label>
      <input type="text" id="patch-id" placeholder="e.g. 1"><br><br>

      <!-- Partial JSON data -->
      <label for="patch-data">Data to Update (JSON):</label><br>
      <textarea id="patch-data" name="data" rows="6" cols="40" placeholder='{"farm_location": "UK"}'></textarea><br><br>

      <!-- Submit -->
      <button type="submit">Run PATCH</button>
    </form>
  </div>
</section>

<!-- Interface for the DELETE request -->
<section id="DELETE" class="hidden">
  <div class="container">
    <div class="subtitle">Enter Your DELETE Request</div>
    <form id="delete-form">

      <!-- Table input -->
      <label for="delete-table">Table:</label>
      <input type="text" id="delete-table" placeholder="e.g. Farm"><br><br>

      <!-- ID to delete -->
      <label for="delete-id">Row ID to Delete:</label>
      <input type="text" id="delete-id" placeholder="e.g. 1"><br><br>

      <!-- Submit -->
      <button type="submit">Run DELETE</button>
    </form>
  </div>
</section>

  <!-- Interface for the sql querying -->
<section id="FULLQUERY" class="hidden"> <!-- Uses the container format so everything in these tags is in a box -->
  <div class="container">
    <div class="subtitle">Enter an SQL Query - Only SELECT allowed</div> <!-- Uses the class subtitle to format the text enter SQL Query-->
    <form id="query-form"> <!-- Opens the query form box -->
      <textarea id="sql-input" placeholder="e.g. SELECT * FROM Farm;"></textarea> <!-- adds place holder text inside the input box -->
      <br>
      <button type="submit">Run Query</button>
    </form>
  </div>
</section>

  <!-- Interface for the Output -->
  <div class="container">
    <div class="subtitle">Output</div>
    <div id="output-box">Query results will appear here...</div>
  </div>

</body>
</html>

 <script>
    // Grab all sections
    const sections = document.querySelectorAll("#GET, #POST, #PUT, #PATCH, #DELETE,#FULLQUERY");

    // Attach click handler to dropdown links
    document.querySelectorAll(".dropdown-content a").forEach(link => {
      link.addEventListener("click", function (e) {
        e.preventDefault(); // stop page reload

        // Hide all sections
        sections.forEach(section => section.classList.add("hidden"));

        // Show selected section
        const targetId = this.getAttribute("data-target");
        document.getElementById(targetId).classList.remove("hidden");
      });
    });
  </script>


  <script>
    // creating a script to build the GET http request from the user input
      document.getElementById("get-form").addEventListener("submit", function (e) {
      e.preventDefault(); // stop page reload

      // get the user inputs from the form
      const table = document.getElementById("get-table").value;
      const id = document.getElementById("get-id").value;
      
      // construct the URL to send to the API
      let url = `https://agriculture-api-jlg-g2gffahdgxfqc6b3.swedencentral-01.azurewebsites.net/${table}`;
      if (id) url += `/${id}`;

      // fetch from the API
      fetch(url)
        .then(response => response.json())
        .then(data => {
          document.getElementById("output-box").innerHTML = "<pre>" + JSON.stringify(data, null, 3) + "<pre>";
        })
        .catch(error => {
          document.getElementById("output-box").innerHTML = error.message;
        });
        });
  </script>

  <script>
    // creating a script to build the POST http request from the user input
      document.querySelector('#post-form').addEventListener('submit', e => {
      e.preventDefault();
      
      // get the user inputs from the form
      const table = document.getElementById("post-table").value;
      const data = document.getElementById("post-data").value;

      // fetch from the API
      fetch(`https://agriculture-api-jlg-g2gffahdgxfqc6b3.swedencentral-01.azurewebsites.net/${table}`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: data
      })
        .then(res => res.json())
        .then(data => {
          document.getElementById("output-box").innerHTML = "<pre>" + JSON.stringify(data, null, 3) + "<pre>";
        })
        .catch(err =>{
          document.getElementById("output-box").innerHTML = err.message;
        })
    });
  </script>

  <script>
    // creating the script for the PUT http request from the user input
    document.querySelector('#put-form').addEventListener('submit', e => {
      e.preventDefault();

      // get the user inputs from the form
      const table = document.getElementById("put-table").value;
      const id = document.getElementById("put-id").value;
      const data = document.getElementById("put-data").value;

      // Fetch from the API
      fetch(`https://agriculture-api-jlg-g2gffahdgxfqc6b3.swedencentral-01.azurewebsites.net/${table}/${id}`, {
        method: 'PUT',
        headers: {
          'Content-Type': 'application/json'
        },
        body: data
      })
        .then(res => res.json())
        .then(data => {
          document.getElementById("output-box").innerHTML = "<pre>" + JSON.stringify(data, null, 3) + "<pre>";
        })
        .catch(err => {
          document.getElementById("output-box").innerHTML = err.message;
        
        })
    });
  </script>

  <script>
    // creating the script for the PATCH http request from the user input
    document.querySelector('#patch-form').addEventListener('submit', e => {
      e.preventDefault();

      // get the user inputs from the form
      const table = document.getElementById("patch-table").value;
      const id = document.getElementById("patch-id").value;
      const data = document.getElementById("patch-data").value;

      // Fetch from the API
      fetch(`https://agriculture-api-jlg-g2gffahdgxfqc6b3.swedencentral-01.azurewebsites.net/${table}/${id}`, {
        method: 'PATCH',
        headers: {
          'Content-Type': 'application/json'
        },
        body: data
      })
        .then(res => res.json())
        .then(data => { 
          document.getElementById("output-box").innerHTML = "<pre>" + JSON.stringify(data, null, 3) + "<pre>";
        })
        .catch(err=> {
          document.getElementById("output-box").innerHTML = err.message;
        })
    });
  </script>

  <script>
    // creating the script for the DELETE http request from the user input
    document.querySelector('#delete-form').addEventListener('submit', e => {
      e.preventDefault();

      const table = document.getElementById("delete-table").value;
      const id = document.getElementById("delete-id").value;

      fetch(`https://agriculture-api-jlg-g2gffahdgxfqc6b3.swedencentral-01.azurewebsites.net/${table}/${id}`, {
        method: 'DELETE',
        headers: {
          'Content-Type': 'application/json'
        }
      })
      .then(res => res.json())
      .then(data => { 
          document.getElementById("output-box").innerHTML = "<pre>" + JSON.stringify(data, null, 3) + "<pre>";
        })
        .catch(err=> {
          document.getElementById("output-box").innerHTML = err.message;
        })
    });
  </script>

  <script>
    // full query script
    document.getElementById("query-form").addEventListener("submit", (e) => {
    e.preventDefault(); 

    // get the SQL query from the input box
    const sql = document.getElementById("sql-input").value;
    const out = document.getElementById("output-box");

    // send the query to the API
    fetch("https://agriculture-api-jlg-g2gffahdgxfqc6b3.swedencentral-01.azurewebsites.net/query", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ sql })
    })
      .then(r => r.json())
      .then(data => { 
        document.getElementById("output-box").innerHTML = "<pre>" + JSON.stringify(data, null, 3) + "<pre>"; 
      })
      .catch(err => { 
        document.getElementById("output-box").innerHTML = err.message; 
      });
  });
</script>


<!-- References -->
<!-- https://www.youtube.com/watch?v=XHokFQeQ6Lk -->
<!-- https://www.w3schools.com/js/js_api_fetch.asp -->










